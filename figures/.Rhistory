alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "none") +
#       legend.background = element_rect(fill= NA),
#       legend.key.size = unit(0.4, "cm"),
#       legend.key.width = unit(0.4,"cm"),
#       legend.title = element_text(size = 13),
#       legend.text = element_text(size = 13),
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill=guide_legend(title="selection")) +
ylab("Allele frequency") +
ggtitle("Effect of selection") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
resultsplot <- read.csv("../../sex.bias/rscripts/parsing/Autosome.rare.male.csv", row.names = 1,
as.is = T, header = T, check.names = F)
resultsplot <- resultsplot[(resultsplot$rd == 0.5),]
resultsplot <- resultsplot[(resultsplot$h == "h0.5"),]
resultsplot <- resultsplot[(resultsplot$s == "s0.5"),]
resultsplot <- resultsplot[(resultsplot$comm == 500),]
resultsplot2 <- resultsplot
resultsplot2$s <- c(0.5)
colnames(resultsplot2) <- c("frequency", "common.sex", "osr", "rd", "h", "s")
autosomal <- ggplot(resultsplot2, aes(y=1-frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "bottom",
legend.background = element_rect(fill= NA),
legend.key.size = unit(0.1, "cm"),
legend.key.width = unit(0.25,"cm"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("Autosomal") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(autosomal)
autosomal <- ggplot(resultsplot2, aes(y=1-frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "bottom",
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("Autosomal") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(autosomal)
autosomal.leg <- get_legend(autosomal)
autosomal <- ggplot(resultsplot2, aes(y=1-frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "none") +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("Autosomal") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(autosomal)
resultsplot <- read.csv("../../sex.bias/rscripts/parsing/Xchrom.rare.male.csv", row.names = 1,
as.is = T, header = T, check.names = F)
resultsplot <- resultsplot[(resultsplot$rd == 0.1),]
resultsplot <- resultsplot[(resultsplot$h == "h0.5"),]
resultsplot <- resultsplot[(resultsplot$s == "s0.5"),]
resultsplot <- resultsplot[(resultsplot$comm == 500),]
resultsplot2 <- resultsplot
resultsplot2$s <- c(0.5)
colnames(resultsplot2) <- c("frequency", "common.sex", "osr", "rd", "h", "s")
xchrom <- ggplot(resultsplot2, aes(y=frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "bottom",
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("X chromosome") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(xchrom)
xchrom.leg <- get_legend(xchrom)
xchrom <- ggplot(resultsplot2, aes(y=frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "none") +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("X chromosome") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(xchrom)
resultsplot <- read.csv("../../sex.bias/rscripts/parsing/Ychrom.rare.female.csv", row.names = 1,
as.is = T, header = T, check.names = F)
resultsplot <- resultsplot[(resultsplot$rd == 0.1),]
resultsplot <- resultsplot[(resultsplot$h == "h0.5"),]
resultsplot <- resultsplot[(resultsplot$s == "s0.5"),]
resultsplot <- resultsplot[(resultsplot$comm == 500),]
resultsplot2 <- resultsplot
resultsplot2$s <- c(0.5)
colnames(resultsplot2) <- c("frequency", "common.sex", "osr", "rd", "h", "s")
ychrom <- ggplot(resultsplot2, aes(y=frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom',
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (Males)") +
ylab("Allele frequency") +
ggtitle("Y chromosome") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(ychrom)
ychrom.leg <- get_legend(ychrom)
ychrom <- ggplot(resultsplot2, aes(y=frequency, x=as.factor(common.sex))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'none') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (Males)") +
ylab("Allele frequency") +
ggtitle("Y chromosome") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(ychrom)
hd.rare.mal <- read.csv("../../sex.bias/figures/HD/parsed.HD.rare.male.csv",
header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
result.s <- hd.rare.mal[(hd.rare.mal$s == "s0.5"),]
result.h <- result.s[(result.s$h == "h=0.5"),]
result.h$h <- c(0.5)
result.h$s <- c(0.5)
results.500 <- result.h[(result.h$comm == "comm.sex500"),]
results.500$comm <- rep(500, length(results.500$comm))
results.500$osr[results.500$osr == "osr1"] <- 1
results.500$osr[results.500$osr == "osr0.8"] <- 0.8
results.500$osr[results.500$osr == "osr0.6"] <- 0.6
results.500$osr[results.500$osr == "osr0.4"] <- 0.4
results.500$osr[results.500$osr == "osr0.2"] <- 0.2
results.500$osr[results.500$osr == "osr0.1"] <- 0.1
results.500$osr[results.500$osr == "osr0.05"] <- 0.05
haplodiploidy.fem <- ggplot(results.500, aes(y=freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom',
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare males") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(haplodiploidy.fem)
hd.fem <- ggplot(results.500, aes(y=freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom',
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare males") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(haplodiploidy.fem)
print(hd.fem)
hd.fem.leg <- get_legend(hd.fem)
hd.fem <- ggplot(results.500, aes(y=freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare males") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(hd.fem)
hd.fem <- ggplot(results.500, aes(y=freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'none') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (females)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare males") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(hd.fem)
# Haplodiploidy rare females (Common sex = 500, s=0.5, h=0.5)
hd.rare.fem <- read.csv("../../sex.bias/figures/HD/parsed.HD.rare.female.csv",
header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
result.s <- hd.rare.fem[(hd.rare.fem$s == "s0.5"),]
result.h <- result.s[(result.s$h == "h=0.5"),]
result.h$h <- c(0.5)
result.h$s <- c(0.5)
results.500 <- result.h[(result.h$comm == "comm.sex500"),]
results.500$comm <- rep(500, length(results.500$comm))
results.500$osr[results.500$osr == "osr1"] <- 1
results.500$osr[results.500$osr == "osr0.8"] <- 0.8
results.500$osr[results.500$osr == "osr0.6"] <- 0.6
results.500$osr[results.500$osr == "osr0.4"] <- 0.4
results.500$osr[results.500$osr == "osr0.2"] <- 0.2
results.500$osr[results.500$osr == "osr0.1"] <- 0.1
results.500$osr[results.500$osr == "osr0.05"] <- 0.05
hd.mal <- ggplot(results.500, aes(y=1-freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom',
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (Males)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare females") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(hd.mal)
hd.mal.leg <- get_legend(hd.mal)
hd.mal <- ggplot(results.500, aes(y=1-freq, x=as.factor(comm))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") + theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'none') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) + xlab("Common sex (Males)") +
ylab("Allele frequency") +
ggtitle("HD model - Rare females") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(hd.mal)
esd.rare.mal <- read.csv("../results/ESD.raremal.csv",
header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
result.plot <- esd.rare.mal[(esd.rare.mal$s == 0.5),]
result.plot <- result.plot[(result.plot$h == 0.5),]
results.500 <- result.plot[(result.plot$num.com == 500),]
esd.rare.mal <- ggplot(results.500, aes(y=freq0, x=as.factor(num.com))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha=.5) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom',
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("ESD") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(esd.rare.mal)
esd.rare.mal.leg <- get_legend(esd.rare.mal)
esd.rare.mal <- ggplot(results.500, aes(y=freq0, x=as.factor(num.com))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha=.5) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'bottom') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("ESD") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(esd.rare.mal)
esd.rare.mal <- ggplot(results.500, aes(y=freq0, x=as.factor(num.com))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha=.5) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge", alpha=0.8, trim=TRUE,
scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = 'none') +
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
# guides(fill= guide_legend(title= "OSR")) +
ylab("Allele frequency") +
ggtitle("ESD") +
scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
print(esd.rare.mal)
library(cowplot)
g1 <- ggplotGrob(dominance)
g2 <- ggplotGrob(rd)
g3 <- ggplotGrob(selection)
g4 <- ggplotGrob(autosomal)
g5 <- ggplotGrob(xchrom)
g6 <- ggplotGrob(ychrom)
g7 <- ggplotGrob(haplodiploidy.fem)
g8 <- ggplotGrob(haplodiploidy.mal)
g9 <- ggplotGrob(esd.rare.mal)
g1 <- ggplotGrob(dominance)
g2 <- ggplotGrob(rd)
g3 <- ggplotGrob(selection)
g4 <- ggplotGrob(autosomal)
g5 <- ggplotGrob(xchrom)
g6 <- ggplotGrob(ychrom)
g7 <- ggplotGrob(hd.fem)
g8 <- ggplotGrob(hd.mal)
g9 <- ggplotGrob(esd.rare.mal)
plot_grid(
g1, g2, g3, g4, g5, g6, g7, g8, g9, ncol=3,
labels = c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'),
align="hv"
)
resultsplot <- read.csv("../../sex.bias/rscripts/parsing/Autosome.rare.male.csv", row.names = 1,
as.is = T, header = T, check.names = F)
resultsplot <- resultsplot[(resultsplot$rd == 0.5),]
resultsplot <- resultsplot[(resultsplot$h != "h99"),]
resultsplot <- resultsplot[(resultsplot$s == "s0.5"),]
resultsplot <- resultsplot[(resultsplot$comm == 500),]
resultsplot2 <- resultsplot
resultsplot2$s <- c(0.5)
colnames(resultsplot2) <- c("frequency", "common.sex", "osr", "rd", "h", "s")
# Facet by dominance to show the effect of different genetic architectures. Comm.sex = 500. OSR = 1
resultsplot3 <- resultsplot2[resultsplot2$osr == 1,]
# Facet by dominance to show the effect of different genetic architectures. Comm.sex = 500. OSR = 1
resultsplot3 <- resultsplot2[resultsplot2$osr == 1,]
dominance <- ggplot(resultsplot3, aes(y=frequency, x=as.factor(h))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(h)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank()) +
axis.ticks.x=element_blank(),
legend.position = "none",
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5,)) +
guides(fill=guide_legend(title="Dominance factor")) +
ylab("Allele frequency") +
ggtitle("Effect of genetic architecture") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
dominance <- ggplot(resultsplot3, aes(y=1-frequency, x=as.factor(h))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(h)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 16),
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5,)) +
guides(fill=guide_legend(title="Dominance factor")) +
ylab("Allele frequency") +
ggtitle("Effect of genetic architecture") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
print(dominance)
dominance <- ggplot(resultsplot3, aes(y=frequency, x=as.factor(h))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(h)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 16),
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5,)) +
guides(fill=guide_legend(title="Dominance factor")) +
ylab("Allele frequency") +
ggtitle("Effect of genetic architecture") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
print(dominance)
dominance.leg <- get_legend(dominance)
dominance <- ggplot(resultsplot3, aes(y=frequency, x=as.factor(h))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(h)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "none") +
legend.text = element_text(size = 16),
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5,)) +
guides(fill=guide_legend(title="Dominance factor")) +
ylab("Allele frequency") +
ggtitle("Effect of genetic architecture") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
dominance <- ggplot(resultsplot3, aes(y=frequency, x=as.factor(h))) +
ylim(0, 1) +
geom_hline(yintercept = .5, alpha = .5) +
geom_violin(aes(fill=as.factor(h)), stat="ydensity", position="dodge",
alpha=0.8, trim=TRUE, scale="area") +
theme_light() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
legend.position = "none") +
#       legend.text = element_text(size = 16),
#       text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5,)) +
# guides(fill=guide_legend(title="Dominance factor")) +
ylab("Allele frequency") +
ggtitle("Effect of genetic architecture") +
scale_fill_viridis(discrete=TRUE, option = "B") +
scale_color_viridis(discrete=TRUE, option = "B")
print(dominance)
g1 <- ggplotGrob(dominance)
g2 <- ggplotGrob(rd)
g3 <- ggplotGrob(selection)
g4 <- ggplotGrob(autosomal)
g5 <- ggplotGrob(xchrom)
g6 <- ggplotGrob(ychrom)
g7 <- ggplotGrob(hd.fem)
g8 <- ggplotGrob(hd.mal)
g9 <- ggplotGrob(esd.rare.mal)
plot_grid(
g1, g2, g3, g4, g5, g6, g7, g8, g9, ncol=3,
labels = c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'),
align="hv"
)
legends <- c(dominance.leg, rd.leg, selection.leg, autosomal.leg, xchrom.leg, ychrom.leg,
hd.fem.leg, hd.mal.leg, esd.rare.mal.leg)
as_ggplot(legends)
as_ggplot(ldominance.leg)
as_ggplot(dominance.leg)
as_ggplot(dominance.leg) + as_ggplot(rd.leg)
as_ggplot(legends)
legends2 <- as.grob(legends)
library(cowplot)
legends2 <- as.grob(legends)
dom <- as.grob(dominance.leg)
?as_grob
