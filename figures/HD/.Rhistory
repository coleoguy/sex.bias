setwd("~/Desktop/Dropbox/sex.bias")
library(ggraptR)
library(viridis)
load("../sex.bias/rscripts/results/esd.RData")
esd.rare.mal <- results
resultsplot <- esd.rare.mal[(esd.rare.mal$h ==0.5),]
ggplot(resultsplot, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
resultsplot2 <- resultsplot[(resultsplot$s >= 0.5),]
ggplot(resultsplot2, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
setwd("~/Desktop/Dropbox/sex.bias")
ls
ls()
wd()
setwd("~/Desktop/Dropbox/sex.bias/figures/ESD")
library(ggraptR)
library(viridis)
load("../sex.bias/rscripts/results/esd.RData")
load("../../sex.bias/rscripts/results/esd.RData")
load("../../../sex.bias/rscripts/results/esd.RData")
esd.rare.mal <- results
resultsplot <- esd.rare.mal[(esd.rare.mal$h ==0.5),]
p1 <- ggplot(resultsplot, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "esd.raremal.h05.pdf",
plot= p1, width=5, height=4, units="in")
ggsave(filename = "esd.raremal.h05.pdf",
plot= p1, width=7, height=6, units="in")
ggsave(filename = "esd.raremal.h05.pdf",
plot= p1, width=9, height=8, units="in")
ggsave(filename = "esd.raremal.h05.pdf",
plot= p1, width=11, height=10, units="in")
resultsplot2 <- resultsplot[(resultsplot$s >= 0.5),]
p2 <- ggplot(resultsplot2, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "esd.raremal.h05.s>=.5.pdf",
plot= p1, width=11, height=10, units="in")
ggsave(filename = "esd.raremal.h05.pdf",
plot= p1, width=11, height=10, units="in")
resultsplot2 <- resultsplot[(resultsplot$s >= 0.5),]
p2 <- ggplot(resultsplot2, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "esd.raremal.h05.s>=.5.pdf",
plot= p2, width=11, height=10, units="in")
resultsplot3 <- resultsplot[(resultsplot$s == 0.1),]
resultsplot4 <- resultsplot[(resultsplot$s == 0.9),]
rplot <- rbind(resultsplot3, resultsplot4)
p3 <- ggplot(rplot, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "esd.raremal.h05.s=0.1&0.9.pdf",
plot= p3, width=11, height=10, units="in")
library(ggraptR)
library(viridis)
load("../../../sex.bias/rscripts/results/hd.rare.males.RData")
hd.rare.mal <- results
View(hd.rare.mal)
resultsplot <- hd.rare.mal[(hd.rare.mal[[i]][[j]][[k]][[m]] == "h=0.5"),]
i<-j<-k<-m<- 1
resultsplot <- hd.rare.mal[(hd.rare.mal[[i]][[j]][[k]][[m]] == "h=0.5"),]
library(readr)
dataset <- read_csv(NULL)
View(dataset)
View(results)
load("../../../sex.bias/rscripts/results/hd.rare.males.RData")
hd.rare.mal <- results
library(readr)
parsed_HD_rare_male <- read_csv("~/Desktop/Dropbox/sex.bias/figures/parsed.HD.rare.male.csv")
View(parsed_HD_rare_male)
setwd("~/Desktop/Dropbox/sex.bias/figures")
hd.rare.mal <- read.csv("parsed.HD.rare.male.csv", header = TRUE, sep = ",", as.is = T)
View(hd.rare.mal)
library(ggraptR)
library(viridis)
hd.rare.mal <- read.csv("parsed.HD.rare.male.csv", header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
View(hd.rare.mal)
resultsplot <- hd.rare.mal[(hd.rare.mal$h ==0.5),]
resultsplot <- hd.rare.mal[(hd.rare.mal$h == "h=0.5"),]
View(resultsplot)
ggplot(resultsplot, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the male beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(resultsplot, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
View(resultsplot)
ggplot(resultsplot, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
resultsplot2 <- hd.rare.mal[(hd.rare.mal$h == "h=1"),]
ggplot(resultsplot, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(resultsplot2, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
resultsplot3 <- hd.rare.mal[(hd.rare.mal$h == "h=0"),]
ggplot(resultsplot3, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
result.h <- hd.rare.mal[(hd.rare.mal$s == "s0.5"),]
View(result.h)
ggplot(result.h, aes(y=freq, x=as.factor(osr))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
results.1000 <- result.h[(result.h$comm == "comm.sex1000"),]
results.100 <- result.h[(result.h$comm == "comm.sex100"),]
result.h <- rbind(results.1000, results.100)
ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_ipsum() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
p4 <- ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "hd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in")
ggsave(filename = "hd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in", path = "figures/HD")
ggsave(filename = "hd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in", path = "../figures/HD")
result.h <- hd.rare.mal[(hd.rare.mal$s == "s0.9"),]
results.1000 <- result.h[(result.h$comm == "comm.sex1000"),]
results.100 <- result.h[(result.h$comm == "comm.sex100"),]
result.h <- rbind(results.1000, results.100)
p5 <- ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "hd.raremal.s09.pdf",
plot= p5, width=11, height=10, units="in", path = "../figures/HD")
View(result.h)
library(ggplot2)
library(viridis)
pop500.melted <- read.csv("../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
setwd("~/Desktop/Dropbox/sex.bias/figures/Fitness.plots/XY.model")
pop500.melted <- read.csv("../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
pop500.melted <- read.csv("../../../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
setwd("~/Desktop/Dropbox/sex.bias/figures")
pop500.melted <- read.csv("../../../../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
pop500.melted <- read.csv("../../../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
pop500.melted <- read.csv("../../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
pop500.melted <- read.csv("../../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
pop500.melted <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
ggplot(pop500.melted, aes(y= value, x= rd)) +
geom_point(aes(colour= as.factor(variable)), stat="identity", alpha=0.4, size=3) +
theme_classic() + theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
guides(colour=guide_legend(title="OSR value
and genetic
architecture")) +
xlab("Recombination distance (rd)") +
ylab("Net masculinization (males/females)")
ggplot(pop500.melted, aes(x=rd, y=value, col=variable)) + geom_line() + xlab('rd') +
ylab('fitness ratio')
pop100.melted <- read.csv("../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.melted.csv")
pop100.melted <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.melted.csv")
ggplot(pop100.melted, aes(y= value, x= rd)) +
geom_point(aes(colour= as.factor(variable)), stat="identity", alpha=0.4, size=3) +
theme_grey() + theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
guides(colour=guide_legend(title="OSR value
and genetic
architecture")) +
xlab("Recombination distance (rd)") +
ylab("Net masculinization (males/females)")
pop100.h0 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h0.csv")
pop100.h05 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h05.csv")
pop100.h1 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h1.csv")
pop100.merged = merge(pop100.h0, pop100.h05, by="rd")
pop100.merged.h = merge(pop100.merged, pop100.h1, by = "rd")
head(pop100.merged.h)
pop100.melted <- reshape2::melt(pop100.merged.h, id.var='rd')
ggraptR(pop100.melted)
ggplot(pop100.melted, aes(x=rd, y=value, col=variable)) + geom_line() + xlab('rd') +
ylab('fitness ratio')
pop500.melted <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop500.melted.csv")
ggplot(pop500.melted, aes(y= value, x= rd)) +
geom_point(aes(colour= as.factor(variable)), stat="identity", alpha=0.4, size=3) +
theme_classic() + theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
guides(colour=guide_legend(title="OSR value
and genetic
architecture")) +
xlab("Recombination distance (rd)") +
ylab("Net masculinization (males/females)")
ggplot(pop500.melted, aes(x=rd, y=value, col=variable)) + geom_line() + xlab('rd') +
ylab('fitness ratio')
# Plot the recessive genetic architecture
rfem.xy.h0 <- read.csv("../../sex.bias/rscripts/parsing/sex.differences/h0.rfem.sexchrom.csv",
row.names = 1, as.is = T, header = T, check.names = F)
# Force as matrix in order to generate melted results with Pop. size and OSR as separate variables
rfem.xy.h0 <- as.matrix(rfem.xy.h0)
melted_result <- melt(rfem.xy.h0[1:7,])
melted_result$Var2 <- as.factor(melted_result$Var2)
# Julio Rincones-Gamboa
# jgamboa@bio.tamu.edu
# j.a.r.gamboa@gmail.com
# P.I. Dr. Heath Blackmon
# coleoguy@gmail.com
library(reshape)
library(viridis)
library(ggplot2)
# Force as matrix in order to generate melted results with Pop. size and OSR as separate variables
rfem.xy.h0 <- as.matrix(rfem.xy.h0)
melted_result <- melt(rfem.xy.h0[1:7,])
melted_result$Var2 <- as.factor(melted_result$Var2)
ggplot(data = melted_result,
aes(x=Var1, y=Var2, fill=value)) +
xlab("Operational sex ratio") +
ylab("Common sex number (Males)") +
geom_tile(color="white") +
scale_fill_viridis(name = "Fitness difference",
limit = c(-.35,.35), guide = "colourbar") +
theme(legend.text = element_text(size=7),
legend.title = element_text(size=7),
axis.title.x = element_text(size=8),
axis.title.y = element_text(size=8),
axis.text.x = element_text(size=7),
axis.text.y = element_text(size=7))
View(melted_result)
library(ggplot2)
library(ggraptR)
library(viridis)
# load  the individual files for pop size 100
pop.100.h0 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h0.csv")
pop.100.h05 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h05.csv")
pop.100.h1 <- read.csv("../../sex.bias/rscripts/parsing/rd.parsing/rare.females/pop100.h1.csv")
# merge them
pop100.merged = merge(pop.100.h0, pop.100.h05, by="rd")
pop100.merged = merge(pop100.merged, pop.100.h1, by = "rd")
pop100.melted.test <- reshape2::melt(pop100.merged, id.var='rd')
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
test <- pop100.melted.test
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
View(pop100.melted.test)
# if loading the data
test <- read.csv("../Fitness.plots/XY.model/cvs.rare.fem/pop100.rfem.melted.test.csv",
row.names = 1, as.is = T, header = T, check.names = F)
# if loading the data
test <- read.csv("../../Fitness.plots/XY.model/cvs.rare.fem/pop100.rfem.melted.test.csv",
row.names = 1, as.is = T, header = T, check.names = F)
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
View(pop100.melted.test)
# if loading the data
test <- read.csv("../../Fitness.plots/XY.model/rd.plots/pop100.rfem.melted.test.csv",
row.names = 1, as.is = T, header = T, check.names = F)
# if loading the data
test <- read.csv("../Fitness.plots/XY.model/rd.plots/pop100.rfem.melted.test.csv",
row.names = 1, as.is = T, header = T, check.names = F)
# if loading the data
test <- read.csv("Fitness.plots/XY.model/rd.plots/pop100.rfem.melted.test.csv",
row.names = 1, as.is = T, header = T, check.names = F)
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_classic() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=3) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
View(test)
View(pop100.merged)
View(pop100.melted.test)
View(pop100.melted.test)
View(pop100.merged)
View(test)
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=2) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=2.5) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
pop100 <- ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=2.5) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggsave(filename = "xy.fitdiff.rd.rfem.100.pdf",
plot= p1, width=8, height=7, units="in", path = "../Figures/rd.plots")
pop100 <- ggplot(test, aes(y= Fitness.difference, x= rd)) +
geom_point(aes(colour= architecture), stat="identity", position="identity", alpha=1, size=2.5) +
scale_color_viridis_d(begin = 0, end = 1)+
facet_grid(OSR ~ .) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5)) + scale_size(range=c(1, 3)) +
ggtitle("Fitness difference when males are the common sex.
Males = 100. OSR = 0.2, 0.1, and 0.05") +
xlab("recombination distance (rd)") + ylab("Fitness difference")
ggsave(filename = "xy.fitdiff.rd.rfem.100.pdf",
plot= pop100, width=8, height=7, units="in", path = "../Figures/rd.plots")
load("../../../sex.bias/rscripts/results/esd.RData")
setwd("~/Desktop/Dropbox/sex.bias")
load("../../../sex.bias/rscripts/results/esd.RData")
setwd("~/Desktop/Dropbox/sex.bias/figures/ESD")
library(ggraptR)
library(viridis)
load("../../../sex.bias/rscripts/results/esd.RData")
esd.rare.mal <- results
resultsplot <- esd.rare.mal[(esd.rare.mal$h ==0.5),]
result.h <- esd.rare.mal[(esd.rare.mal$s == "s0.9"),]
results.1000 <- result.h[(result.h$comm == "comm.sex1000"),]
View(esd.rare.mal)
result.h <- esd.rare.mal[(esd.rare.mal$s == 0.5),]
results.1000 <- result.h[(result.h$num.com == 1000),]
results.100 <- result.h[(result.h$num.com == 100),]
result.h <- rbind(results.1000, results.100)
ggplot(result.h, aes(y=freq, x=as.factor(comm))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="osr")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(result.h, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(osr)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggplot(result.h, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
View(results)
p4 <- ggplot(result.h, aes(y=freq0, x=as.factor(num.com))) +
geom_violin(aes(fill=as.factor(OSR)), stat="ydensity", position="dodge",
alpha=0.5, trim=TRUE, scale="area") + facet_grid(h ~ s) + theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="OSR")) + xlab("Common sex (females)") +
ylab("Frequency of the female beneficial allele") + scale_fill_viridis(discrete=TRUE) +
scale_color_viridis(discrete=TRUE)
ggsave(filename = "esd.raremal.s05.pdf",
plot= p5, width=11, height=10, units="in", path = "../figures/ESD")
ggsave(filename = "esd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in", path = "../figures/ESD")
ggsave(filename = "esd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in", path = "../figures/ESD/")
setwd("~/Desktop/Dropbox/sex.bias/figures/ESD")
load("../../../sex.bias/rscripts/results/esd.RData")
ggsave(filename = "esd.raremal.s05.pdf",
plot= p4, width=11, height=10, units="in")
hd.rare.mal <- read.csv("parsed.HD.rare.male.csv", header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
setwd("~/Desktop/Dropbox/sex.bias/figures/HD")
hd.rare.mal <- read.csv("parsed.HD.rare.male.csv", header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
hd.rare.mal <- read.csv("../parsed.HD.rare.male.csv", header = TRUE, sep = ",", as.is = T, check.names = F,
row.names = 1)
View(hd.rare.mal)
