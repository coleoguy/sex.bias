tiplabels(pch = 16, col = cols, cex = .5)
# make a likelihood function to estimate the likelihood of observing the data given certain
# parameters.
lik <- make.mk2(tree = phy,
states = data)
lik(pars = c(.1, .5))
# make a loop to iterate through different values of these parameters and store the results
x <- seq(from=0, to=1, length.out = 100)
lik.results <- c()
for(i in 1:100){
lik.results[i] <- lik(pars= c(.1, x[i]))
}
plot(x = x, y = lik.results, type = "l")
# fit this likelihood. Tell where in parameter space to start (preferably always a random spot)
find.mle(lik, x.init = runif(min = 0, max = 1, n = 2))$par
# run another loop for every random spot
mle.results <- matrix(, 100, 2)
for(i in 1:100){
mle.results[i, 1:2] <- find.mle(lik, x.init = runif(min = 0, max = 1, n = 2))$par
}
hist(mle.results[,1])
hist(mle.results[,2])
# Using a bayesian approach (mcmc). Need a tuning parameter 'w'
results <- mcmc(lik, x.init = runif(min = 0, max = 1, n = 2), w = 1, nsteps = 500)
plot(results[,3], type = "l")
post.burnin <- results[~c(1:500),]
post.burnin <- results[-c(1:500),]
library(coda)
HPDinterval(as.mcmc(post.burnin))
# Using a bayesian approach (mcmc). Need a tuning parameter 'w'
results <- mcmc(lik, x.init = runif(min = 0, max = 1, n = 2), w = 1, nsteps = 5000)
# Using a bayesian approach (mcmc). Need a tuning parameter 'w'
results <- mcmc(lik, x.init = runif(min = 0, max = 1, n = 2), w = 1, nsteps = 5000)
# Using a bayesian approach (mcmc). Need a tuning parameter 'w'
results <- diversitree::mcmc(lik, x.init = runif(min = 0, max = 1, n = 2), w = 1, nsteps = 5000)
plot(results[,3], type = "l")
post.burnin <- results[-c(1:5000),]
library(coda)
HPDinterval(as.mcmc(post.burnin))
plot(results[,3], type = "l")
post.burnin <- results[-c(1:500),]
library(coda)
HPDinterval(as.mcmc(post.burnin))
effectiveSize(results[,2])
effectiveSize(post.burnin[,2])
effectiveSize(post.burnin[,3])
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results
xchrom.comm.osr <- matrix(,28,4)
View(xchrom.comm.osr)
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.male.model.RData")
xchrom <- results
View(xchrom)
# first lets load the equal sex data
load("../base.comp.model3.RData")
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# lets remove the extra copy of the results
rm(results)
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.male.model.RData")
res.rare.mal <- results
# lets remove the extra copy of the results
rm(results)
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results
xchrom.comm.osr <- matrix(,28,4)
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.male.model.RData")
res.rare.mal <- results
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# lets remove the extra copy of the results
rm(results)
# set up matrix to store results
xchrom.comm.osr <- matrix(,28,5)
View(xchrom.comm.osr)
colnames(xchrom.comm.osr) <- c("freq", "commsex", "osr", "Ne", "log.Ne")
View(xchrom.comm.osr)
View(xchrom.comm.osr)
com.sex.pop <- 4
View(res.rare.mal)
for(i in seq(from=1, to=7)){
xchrom.comm.osr[i:(i+1), 1] <- mean(res.base[[com.sex.pop]]$rd0.5$h0.5$s0.5[, 3]==1)/1000
com.sex.pop <- com.sex.pop - 1
}
com.sex.pop <- 4
View(xchrom.comm.osr)
for(i in seq(from=1, to =7)){
xchrom.comm.osr[i:(i+1), 1] <- mean(res.base[[com.sex.pop]]$rd0.1$h0.5$s0.5[, 1] ==1)/1000
comm.sex.pop <- com.sex.pop - 1
}
for(i in 2:7){
com.sex.pop <- 4
for(j in seq(from=1, to =7)){
xchrom.comm.osr[j, i] <- mean(res.rare.mal[[com.sex.pop]][[i-1]]$rd0.1$h0.5$s0.5[, 1]==1)/1000
com.sex.pop <- com.sex.pop - 1
}
}
com.sex.pop <- 4
for(j in seq(from=1, to =7)){
xchrom.comm.osr[j, i] <- mean(res.rare.mal[[com.sex.pop]][[i-1]]$rd0.1$h0.5$s0.5[, 1]==1)/1000
com.sex.pop <- com.sex.pop - 1
}
for(i in 2:7){
com.sex.pop <- 4
for(j in seq(from=1, to =7)){
xchrom.comm.osr[j, i] <- mean(res.rare.mal[[com.sex.pop]][[i-1]]$rd0.1$h0.5$s0.5[, 1]==1)/1000
com.sex.pop <- com.sex.pop - 1
}
}
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results
xchrom.comm.osr <- matrix(,28,5)
colnames(xchrom.comm.osr) <- c("freq", "commsex", "osr", "Ne", "log.Ne")
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.male.model.RData")
res.rare.mal <- results
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.male.model.RData")
res.rare.mal <- results
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# lets remove the extra copy of the results
rm(results)
View(res.rare.mal)
# Freq when there is no bias (uses the base.comp.model.RData file)
freq.additive.s05.osr1 <- res.base$pop1000$rd0.5$h0.5$s0.5[,3]
comm1000.osr1 <- mean(freq.additive.s05.osr1)
# First at 1000 comm sex
freq.additive.s05.osr.8 <- res.rare.mal$females1000$males0.8$rd0.2$h0.5$s0.5[,3]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
# Freq when there is no bias (uses the base.comp.model.RData file)
freq.additive.s05.osr1 <- res.base$pop1000$rd0.5$h0.5$s0.5[,1]
comm1000.osr1 <- mean(freq.additive.s05.osr1)
# First at 1000 comm sex
freq.additive.s05.osr.8 <- res.rare.mal$females1000$males0.8$rd0.2$h0.5$s0.5[,1]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.8 <- res.rare.mal$females1000$males0.8$rd0.2$h0.5$s0.5[,1]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
# Freq when there is no bias (uses the base.comp.model.RData file)
freq.additive.s05.osr1 <- res.base$pop1000$rd0.1$h0.5$s0.5[,1]
comm1000.osr1 <- mean(freq.additive.s05.osr1)
# First at 1000 comm sex
freq.additive.s05.osr.8 <- res.rare.mal$females1000$males0.8$rd0.1$h0.5$s0.5[,1]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.mal$females1000$males0.6$rd0.1$h0.5$s0.5[,1]
comm1000.osr.6 8<- mean(freq.additive.s05.osr.6)
# Freq when there is no bias (uses the base.comp.model.RData file)
freq.additive.s05.osr1 <- res.base$pop1000$rd0.1$h0.5$s0.5[,1]
comm1000.osr1 <- mean(freq.additive.s05.osr1)
# First at 1000 comm sex
freq.additive.s05.osr.8 <- res.rare.mal$females1000$males0.8$rd0.1$h0.5$s0.5[,1]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.mal$females1000$males0.6$rd0.1$h0.5$s0.5[,1]
comm1000.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.mal$females1000$males0.4$rd0.1$h0.5$s0.5[,1]
comm1000.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.mal$females1000$males0.2$rd0.1$h0.5$s0.5[,1]
comm1000.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.mal$females1000$males0.1$rd0.1$h0.5$s0.5[,1]
comm1000.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.mal$females1000$males0.05$rd0.1$h0.5$s0.5[,1]
comm1000.osr.05 <- mean(freq.additive.s05.osr.05)
xchrom.comm1000 <- rbind(comm1000.osr1, comm1000.osr.8, comm1000.osr.6, comm1000.osr.4, comm1000.osr.2,
comm1000.osr.1, comm1000.osr.05)
View(xchrom.comm1000)
freq.additive.s05.osr1 <- res.base$pop500$rd0.1$h0.5$s0.5[,1]
comm500.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.mal$females500$males0.8$rd0.1$h0.5$s0.5[,1]
comm500.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.mal$females500$males0.6$rd0.1$h0.5$s0.5[,1]
comm500.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.mal$females500$males0.4$rd0.1$h0.5$s0.5[,1]
comm500.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.mal$females500$males0.2$rd0.1$h0.5$s0.5[,1]
comm500.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.mal$females500$males0.1$rd0.1$h0.5$s0.5[,1]
comm500.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.mal$females500$males0.05$rd0.1$h0.5$s0.5[,1]
comm500.osr.05 <- mean(freq.additive.s05.osr.05)
xchrom.comm500 <- rbind(comm500.osr1, comm500.osr.8, comm500.osr.6, comm500.osr.4, comm500.osr.2,
comm500.osr.1, comm500.osr.05)
freq.additive.s05.osr1 <- res.base$pop100$rd0.1$h0.5$s0.5[,1]
comm100.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.mal$females100$males0.8$rd0.1$h0.5$s0.5[,1]
comm100.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.mal$females100$males0.6$rd0.1$h0.5$s0.5[,1]
comm100.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.mal$females100$males0.4$rd0.1$h0.5$s0.5[,1]
comm100.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.mal$females100$males0.2$rd0.1$h0.5$s0.5[,1]
comm100.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.mal$females100$males0.1$rd0.1$h0.5$s0.5[,1]
comm100.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.mal$females100$males0.05$rd0.1$h0.5$s0.5[,1]
comm100.osr.05 <- mean(freq.additive.s05.osr.05)
xchrom.comm100 <- rbind(comm100.osr1, comm100.osr.8, comm100.osr.6, comm100.osr.4, comm100.osr.2,
comm100.osr.1, comm100.osr.05)
View(xchrom.comm100)
freq.additive.s05.osr1 <- res.base$pop50$rd0.1$h0.5$s0.5[,1]
comm50.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.mal$females50$males0.8$rd0.1$h0.5$s0.5[,1]
comm50.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.mal$females50$males0.6$rd0.1$h0.5$s0.5[,1]
comm50.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.mal$females50$males0.4$rd0.1$h0.5$s0.5[,1]
comm50.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.mal$females50$males0.2$rd0.1$h0.5$s0.5[,1]
comm50.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.mal$females50$males0.1$rd0.1$h0.5$s0.5[,1]
comm50.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.mal$females50$males0.05$rd0.1$h0.5$s0.5[,1]
comm50.osr.05 <- mean(freq.additive.s05.osr.05)
xchrom.comm50 <- rbind(comm50.osr1, comm50.osr.8, comm50.osr.6, comm50.osr.4, comm50.osr.2,
comm50.osr.1, comm50.osr.05)
View(xchrom.comm50)
View(xchrom.comm.osr)
commsex <- rep(c(1000, 500, 100, 50), each = 7)
xchrom.comm.osr[, 2] <- commsex
View(xchrom.comm.osr)
View(xchrom.comm.osr)
osr <- rep(c("osr1", "osr.8", "osr.6", "osr.4", "osr.2", "osr.1", "osr.05"), each = 4)
xchrom.comm.osr[, 3] <- osr
View(xchrom.comm.osr)
osr <- rep(c("osr1", "osr.8", "osr.6", "osr.4", "osr.2", "osr.1", "osr.05"), each = 7)
xchrom.comm.osr[, 3] <- osr
osr <- rep(c("osr1", "osr.8", "osr.6", "osr.4", "osr.2", "osr.1", "osr.05"), each = 4)
xchrom.comm.osr[, 3] <- osr
View(xchrom.comm.osr)
osr <- rep(c("osr1", "osr.8", "osr.6", "osr.4", "osr.2", "osr.1", "osr.05"))
xchrom.comm.osr[, 3] <- osr
osr <- rep(c(1, .8, .6, .4, .2, .1, .05))
xchrom.comm.osr[, 3] <- osr
library(readr)
dataset <- read_csv(NULL)
View(dataset)
library(readr)
var_ne_xchrom <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")
View(var_ne_xchrom)
var_ne_xchrom <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")
View(var_ne_xchrom)
var_ne_xchrom <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")[c(5:8), c(4:10)]
View(var_ne_xchrom)
Ne <- var_ne_xchrom
View(Ne)
Ne.xchrom <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")[c(5:8), c(4:10)]
Ne <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")[c(5:8), c(4:10)]
log.Ne <- log10(Ne.xchrom)
View(Ne.xchrom)
View(log.Ne)
Ne.xchrom <- c()
for(i in 1:nrow(Ne)){
Ne.xchrom <- c(Ne, unlist(Ne[i,1:7]))
}
xchrom.comm.osr[,4] <- Ne.xchrom
xchrom.comm.osr <- cbind(xchrom.comm.osr, log.Ne)
# set up matrix to store results and fill commsex, osr, Ne, and log.Ne columns
xchrom.comm.osr <- matrix(,28,5)
colnames(xchrom.comm.osr) <- c("freq", "commsex", "osr", "Ne", "log.Ne")
commsex <- rep(c(1000, 500, 100, 50), each = 7)
xchrom.comm.osr[, 2] <- commsex
osr <- rep(c(1, .8, .6, .4, .2, .1, .05))
xchrom.comm.osr[, 3] <- osr
Ne <- read_csv("Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/var.ne.xchrom.csv")[c(5:8), c(4:10)]
View(xchrom.comm.osr)
log.Ne <- log10(Ne.xchrom)
View(log.Ne)
Ne.xchrom <- c()
for(i in 1:nrow(Ne)){
Ne.xchrom <- c(Ne, unlist(Ne[i,1:7]))
}
View(Ne.xchrom)
View(Ne)
Ne.xchrom <- c()
for(i in 1:nrow(Ne)){
Ne.xchrom <- c(Ne.xchrom, unlist(Ne[i,1:7]))
}
xchrom.comm.osr[,4] <- Ne.xchrom
log.Ne <- log10(Ne.xchrom)
xchrom.comm.osr <- cbind(xchrom.comm.osr, log.Ne)
xchrom.comm.osr <- cbind(xchrom.comm.osr, log.Ne)[,-c(5)]
xchrom.comm.osr[,-c(5)]
View(xchrom.comm.osr)
xchrom.comm.osr[,-c(6)]
View(xchrom.comm.osr)
xchrom.comm.osr[,c(1:5)]
xchrom.comm.osr <- xchrom.comm.osr[,c(1:5)]
View(xchrom.comm.osr)
xchrom.freq <- rbind(xchrom.comm1000, xchrom.comm500, xchrom.comm100, xchrom.comm50)
xchrom.comm.osr[, 1] <- xchrom.freq
View(xchrom.comm.osr)
xchrom.freq <- as.data.frame(xchrom.comm.osr, stringsAsFactors = F)
class(xchrom.comm.osr$Ne) <- "numeric"
View(xchrom.comm.osr)
ggplot(data = xchrom.comm.osr, aes(x = log.Ne, y = as.numeric(xchrom.freq$freq)))+
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_discrete(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (females) on X chromosomes.
Genetic architecture is additive. s= 0.5")
xchrom.freq <- as.data.frame(xchrom.comm.osr, stringsAsFactors = F)
ggplot(data = xchrom.freq, aes(x = log.Ne, y = as.numeric(xchrom.freq$freq)))+
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_discrete(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (females) on X chromosomes.
Genetic architecture is additive. s= 0.5")
ggplot(data = xchrom.freq, aes(x = log.Ne, y = as.numeric(xchrom.freq$freq)))+
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_discrete(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (females) on X chromosomes.
Genetic architecture is additive. s= 0.5")
ggplot(data = xchrom.freq, aes(x = log.Ne, y = as.numeric(xchrom.freq$freq))) +
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_continuous(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (females) on X chromosomes.
Genetic architecture is additive. s= 0.5")
setwd("~/Desktop/Dropbox/sex.bias/rscripts/results/Ne.allele.freqs/Freqs")
write.csv(autosome.freq, file= "freq.xchrom.additive.s05.csv")
write.csv(xchrom.freq, file= "freq.xchrom.additive.s05.csv")
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results and fill commsex, osr, Ne, and log.Ne columns
xchrom.comm.osr <- matrix(,28,5)
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results and fill commsex, osr, Ne, and log.Ne columns
ychrom.comm.osr <- matrix(,28,5)
colnames(ychrom.comm.osr) <- c("freq", "commsex", "osr", "Ne", "log.Ne")
View(ychrom.comm.osr)
commsex <- rep(c(1000, 500, 100, 50), each = 7)
ychrom.comm.osr[, 2] <- commsex
osr <- rep(c(1, .8, .6, .4, .2, .1, .05))
ychrom.comm.osr[, 3] <- osr
View(ychrom.comm.osr)
Ne <- rep(c(1000, 500, 100, 50), each = 7)
View(ychrom.comm.osr)
Ne.ychrom <- c()
for(i in 1:nrow(Ne)){
Ne.ychrom <- c(Ne.ychrom, unlist(Ne[i,1:7]))
}
log.Ne <- log10(Ne)
ychrom.comm.osr <- cbind(ychrom.comm.osr, log.Ne)[,-c(5)]
View(ychrom.comm.osr)
View(ychrom.comm.osr)
ychrom.comm.osr[, 4] <- Ne
View(ychrom.comm.osr)
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.female.model.RData")
res.rare.mal <- results
res.rare.fem <- results
library(ggplot2)
library(viridis)
library(ggraptR)
# set up matrix to store results and fill commsex, osr, Ne, and log.Ne columns
ychrom.comm.osr <- matrix(,28,5)
colnames(ychrom.comm.osr) <- c("freq", "commsex", "osr", "Ne", "log.Ne")
commsex <- rep(c(1000, 500, 100, 50), each = 7)
ychrom.comm.osr[, 2] <- commsex
osr <- rep(c(1, .8, .6, .4, .2, .1, .05))
ychrom.comm.osr[, 3] <- osr
Ne <- rep(c(1000, 500, 100, 50), each = 7)
ychrom.comm.osr[, 4] <- Ne
log.Ne <- log10(Ne)
ychrom.comm.osr <- cbind(ychrom.comm.osr, log.Ne)[,-c(5)]
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.female.model.RData")
res.rare.fem <- results
View(ychrom.comm.osr)
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# lets remove the extra copy of the results
rm(results)
View(ychrom.comm.osr)
# X chromosome allele frequencies
load("~/Desktop/Dropbox/sex.bias/rscripts/results/rare.female.model.RData")
res.rare.fem <- results
# first lets load the equal sex data
load("~/Desktop/Dropbox/sex.bias/rscripts/results/base.comp.model.RData")
res.base <- results
# lets remove the extra copy of the results
rm(results)
# Freq when there is no bias (uses the base.comp.model.RData file)
freq.additive.s05.osr1 <- res.base$pop1000$rd0.1$h0.5$s0.5[,2]
comm1000.osr1 <- mean(freq.additive.s05.osr1)
# First at 1000 comm sex
freq.additive.s05.osr.8 <- res.rare.fem$males1000$females0.8$rd0.1$h0.5$s0.5[,2]
comm1000.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.fem$males1000$females0.6$rd0.1$h0.5$s0.5[,2]
comm1000.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.fem$males1000$females0.4$rd0.1$h0.5$s0.5[,2]
comm1000.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.fem$males1000$females0.2$rd0.1$h0.5$s0.5[,2]
comm1000.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.fem$males1000$females0.1$rd0.1$h0.5$s0.5[,2]
comm1000.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.fem$males1000$males0.05$rd0.1$h0.5$s0.5[,2]
comm1000.osr.05 <- mean(freq.additive.s05.osr.05)
ychrom.comm1000 <- rbind(comm1000.osr1, comm1000.osr.8, comm1000.osr.6, comm1000.osr.4, comm1000.osr.2,
comm1000.osr.1, comm1000.osr.05)
freq.additive.s05.osr.05 <- res.rare.fem$males1000$females0.05$rd0.1$h0.5$s0.5[,2]
comm1000.osr.05 <- mean(freq.additive.s05.osr.05)
ychrom.comm1000 <- rbind(comm1000.osr1, comm1000.osr.8, comm1000.osr.6, comm1000.osr.4, comm1000.osr.2,
comm1000.osr.1, comm1000.osr.05)
View(ychrom.comm.osr)
View(ychrom.comm1000)
freq.additive.s05.osr1 <- res.base$pop500$rd0.1$h0.5$s0.5[,2]
comm500.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.fem$males500$females0.8$rd0.1$h0.5$s0.5[,2]
comm500.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.fem$males500$females0.6$rd0.1$h0.5$s0.5[,2]
comm500.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.fem$males500$females0.4$rd0.1$h0.5$s0.5[,2]
comm500.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.fem$males500$females0.2$rd0.1$h0.5$s0.5[,2]
comm500.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.fem$males500$females0.1$rd0.1$h0.5$s0.5[,2]
comm500.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.fem$males500$females0.05$rd0.1$h0.5$s0.5[,2]
comm500.osr.05 <- mean(freq.additive.s05.osr.05)
ychrom.comm500 <- rbind(comm500.osr1, comm500.osr.8, comm500.osr.6, comm500.osr.4, comm500.osr.2,
comm500.osr.1, comm500.osr.05)
View(ychrom.comm500)
freq.additive.s05.osr1 <- res.base$pop100$rd0.1$h0.5$s0.5[,2]
comm100.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.fem$males100$females0.8$rd0.1$h0.5$s0.5[,2]
comm100.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.fem$males100$females0.6$rd0.1$h0.5$s0.5[,2]
comm100.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.fem$males100$females0.4$rd0.1$h0.5$s0.5[,2]
comm100.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.fem$males100$females0.2$rd0.1$h0.5$s0.5[,2]
comm100.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.fem$males100$females0.1$rd0.1$h0.5$s0.5[,2]
comm100.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.fem$males100$females0.05$rd0.1$h0.5$s0.5[,2]
comm100.osr.05 <- mean(freq.additive.s05.osr.05)
ychrom.comm100 <- rbind(comm100.osr1, comm100.osr.8, comm100.osr.6, comm100.osr.4, comm100.osr.2,
comm100.osr.1, comm100.osr.05)
View(ychrom.comm100)
freq.additive.s05.osr1 <- res.base$pop50$rd0.1$h0.5$s0.5[,2]
comm50.osr1 <- mean(freq.additive.s05.osr1)
freq.additive.s05.osr.8 <- res.rare.fem$males50$females0.8$rd0.1$h0.5$s0.5[,2]
comm50.osr.8 <- mean(freq.additive.s05.osr.8)
freq.additive.s05.osr.6 <- res.rare.fem$males50$females0.6$rd0.1$h0.5$s0.5[,2]
comm50.osr.6 <- mean(freq.additive.s05.osr.6)
freq.additive.s05.osr.4 <- res.rare.fem$males50$females0.4$rd0.1$h0.5$s0.5[,2]
comm50.osr.4 <- mean(freq.additive.s05.osr.4)
freq.additive.s05.osr.2 <- res.rare.fem$males50$females0.2$rd0.1$h0.5$s0.5[,2]
comm50.osr.2 <- mean(freq.additive.s05.osr.2)
freq.additive.s05.osr.1 <- res.rare.fem$males50$females0.1$rd0.1$h0.5$s0.5[,2]
comm50.osr.1 <- mean(freq.additive.s05.osr.1)
freq.additive.s05.osr.05 <- res.rare.fem$males50$females0.05$rd0.1$h0.5$s0.5[,2]
comm50.osr.05 <- mean(freq.additive.s05.osr.05)
ychrom.comm50 <- rbind(comm50.osr1, comm50.osr.8, comm50.osr.6, comm50.osr.4, comm50.osr.2,
comm50.osr.1, comm50.osr.05)
ychrom.freq <- rbind(ychrom.comm1000, ychrom.comm500, ychrom.comm100, ychrom.comm50)
ychrom.comm.osr[, 1] <- ychrom.freq
View(ychrom.comm.osr)
ychrom.freq <- as.data.frame(ychrom.comm.osr, stringsAsFactors = F)
View(ychrom.freq)
ggplot(data = ychrom.freq, aes(x = log.Ne, y = as.numeric(ychrom.freq$freq))) +
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_continuous(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (male) on the Y chromosome.
Genetic architecture is additive. s= 0.5")
write.csv(ychrom.freq, file= "freq.ychrom.additive.s05.csv")
ggplot(data = ychrom.freq, aes(x = log.Ne, y = as.numeric(ychrom.freq$freq))) +
geom_point(aes(col=as.factor(osr)) , stat="identity", position="jitter", alpha=0.8, size=4) +
scale_x_continuous(breaks =c(0,1,2,3), labels=c(c(1,10,100,1000))) +
xlab("Variance effective population size") +
ylab("Mean allele frequency") +
guides(fill=guide_legend(title="OSR")) +
scale_colour_viridis_d("OSR") +
ggtitle("Mean frequency of the allele benefitting the common sex (males) on the Y chromosome.
Genetic architecture is additive. s= 0.5")
