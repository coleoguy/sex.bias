theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix_h, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=-(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=-(M_FdelA), shape = s, colour = s))+
geom_point(aes(y=(F_MfixA), shape = s, colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = s))+
geom_point(aes(y=(F_MfixA), shape = s, colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=-(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=-(M_FdelA), shape = s, colour = s))+
geom_point(aes(y=(F_MfixA), shape = s, colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = s))+
geom_point(aes(y=(F_MfixA), shape = s, colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour ="M_FdelA",))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), shape = s, colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = "F_MfixA"))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour ="M_FdelA",))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), shape = s, colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = "F_MfixA"))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), shape = s, colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour ="M_FdelA",))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = s))+
geom_point(aes(y=(F_MfixA), shape = s, colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = "F_MfixA"))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = s, colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), shape = s, colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "M_FdelA", colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), shape = "F_MfixA", colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), colour = "M_FdelA"))+
geom_point(aes(y=(F_MfixA), colour = "F_MfixA"))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "M_FdelA", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "F_MfixA", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "Common Male", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "Common Male", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
# AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
#   draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
#   draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "Common Male", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(0,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
# AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
#   draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
#   draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "Common Male", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
# AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
#   draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
#   draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
SexFixCompX
#Y chromosome
SexFixCompY <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelY), colour =s,))+ #common female (allele 2) X - allele 2 is ben (del)
geom_point(aes(y=(M_FdelY), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MfixY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial Y \n"))+
ggtitle("Prob of beneficial Y Fixed, rd = 0.5, h = 0.5")
SexFixCompY
setwd("C:/Users/pdglenn/OneDrive/Github/sex.bias/results")
#Load libraries
library(gridExtra)
library(grid)
library(ggpubr)
library(ggplot2)
library(viridis)
library(vioplot)
library(cowplot)
# first we load our functions
source("../scripts/functions.R")
mdat<-read.csv("rare.male.250.iter.csv", as.is=T, header = TRUE)
simple.mdat <- aggregate(x = mdat,
by = list(mdat$females, mdat$OSR, mdat$rd, mdat$h, mdat$s),
FUN = mean)[,-c(1:5)]
simple.mdat$Wdiff <- simple.mdat$malW <- simple.mdat$femW <- NA
for(i in 1:nrow(simple.mdat)){
fits <- getFits(simple.mdat[i,])
simple.mdat[i,11] <- fits[1]
simple.mdat[i,10] <- fits[2]
simple.mdat[i,12] <- fits[3]
}
simple.mdat$delA <- simple.mdat$fixA <-simple.mdat$delY <-simple.mdat$fixY <- simple.mdat$delX <-simple.mdat$fixX <-  NA
for(i in 1:nrow(simple.mdat)){
fixes <- getProb(simple.mdat, mdat)
simple.mdat[i,13] <- fixes[1]
simple.mdat[i,14] <- fixes[2]
simple.mdat[i,15] <- fixes[3]
simple.mdat[i,16] <- fixes[4]
simple.mdat[i,17] <- fixes[5]
simple.mdat[i,18] <- fixes[6]
}
simple.msex<-simple.mdat[simple.mdat$rd == 0.2,] #Sex-linked
#Exclude h = 99
mfit.sex <- simple.msex[simple.msex$h != 99,]
mfit.sex$females<-as.factor(mfit.sex$females)
mfit.sex$s<-as.factor(mfit.sex$s)
mfit.sex$h<-as.factor(mfit.sex$h)
str(mfit.sex)
fdat<-read.csv("rare.female.250.iter.csv", as.is=T, header = TRUE)
simple.fdat <- aggregate(x = fdat,
by = list(fdat$males, fdat$OSR, fdat$rd, fdat$h, fdat$s),
FUN = mean)[,-c(1:5)]
simple.fdat$Wdiff <- simple.fdat$malW <- simple.fdat$femW <- NA
for(i in 1:nrow(simple.fdat)){
fits <- getFits(simple.fdat[i,])
simple.fdat[i,11] <- fits[1]
simple.fdat[i,10] <- fits[2]
simple.fdat[i,12] <- fits[3]
}
simple.fdat$delA <- simple.fdat$fixA <-simple.fdat$delY <-simple.fdat$fixY <- simple.fdat$delX <-simple.fdat$fixX <-  NA
for(i in 1:nrow(simple.fdat)){
fixes <- getProb(simple.fdat, fdat)
simple.fdat[i,13] <- fixes[1]
simple.fdat[i,14] <- fixes[2]
simple.fdat[i,15] <- fixes[3]
simple.fdat[i,16] <- fixes[4]
simple.fdat[i,17] <- fixes[5]
simple.fdat[i,18] <- fixes[6]
}
simple.fsex<-simple.fdat[simple.fdat$rd == 0.2,] #Sex-linked
#remove 99
ffit.sex <- simple.fsex[simple.fsex$h != 99,]
ffit.sex$males<-as.factor(ffit.sex$males)
ffit.sex$s<-as.factor(ffit.sex$s)
ffit.sex$h<-as.factor(ffit.sex$h)
#Combine the two together since everything is in the same order
SexFit <- mfit.sex[,c(4:8,12)]
colnames(SexFit)[1] <- "common"
colnames(SexFit)[6] <- "M_Wdiff"
SexFit[7] <- ffit.sex[12]
colnames(SexFit)[7] <- "F_Wdiff"
simple.maut<-simple.mdat[simple.mdat$rd == 0.5,] #Autosome
#Exclude h = 99
mfit.aut <- simple.maut[simple.maut$h != 99,]
mfit.aut$females<-as.factor(mfit.aut$females)
mfit.aut$s<-as.factor(mfit.aut$s)
mfit.aut$h<-as.factor(mfit.aut$h)
### Female
simple.faut<-simple.fdat[simple.fdat$rd == 0.5,] #Autosome
#eclude h =99
ffit.aut <- simple.faut[simple.faut$h != 99,]
ffit.aut$males<-as.factor(ffit.aut$males)
ffit.aut$s<-as.factor(ffit.aut$s)
ffit.aut$h<-as.factor(ffit.aut$h)
#Combine the two together since everything is in the same order
AutFit <- mfit.aut[,c(4:8,12)]
colnames(AutFit)[1] <- "common"
colnames(AutFit)[6] <- "M_Wdiff"
AutFit[7] <- ffit.aut[12]
colnames(AutFit)[7] <- "F_Wdiff"
my_labels = c("1.0","0.75","0.50","0.25","0.00","0.25","0.50","0.75","1.0")
my_ticks = c(-1.0,-0.75,-0.50,-0.25,0,0.25,0.5, 0.75,1.0)
SexFit_h <- SexFit[SexFit$h == 0.5,]
SexFitnessComp <- ggplot(SexFit_h, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=M_Wdiff, colour =s))+
geom_point(aes(y=M_Wdiff, shape = s, colour = s))+
geom_point(aes(y=F_Wdiff, shape = s, colour = s))+
geom_line(aes(y=F_Wdiff, colour = s))+
scale_y_continuous(limits = c(-1,1), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Fitness difference (common - rare)\n"))+
ggtitle("Fitness, rd = 0.2, h = 0.5")
SexFitnessComp <- ggdraw() + draw_plot(SexFitnessComp) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
SexFitnessComp
AutFit_h <- AutFit[AutFit$h == 0.5,]
AutFitnessComp <- ggplot(AutFit_h, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=M_Wdiff, colour =s,))+
geom_point(aes(y=M_Wdiff, shape = s, colour = s))+
geom_point(aes(y=F_Wdiff, shape = s, colour = s))+
geom_line(aes(y=F_Wdiff, colour = s))+
scale_y_continuous(limits = c(-1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Fitness difference (common - rare)\n"))+
ggtitle("Fitness, rd = 0.5, h = 0.5")
AutFitnessComp <- ggdraw() + draw_plot(AutFitnessComp) +
draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFitnessComp
AutFix <- mfit.aut[,c(4:8,13:18)]
colnames(AutFix)[1] <- "common"
colnames(AutFix)[c(6:11)] <- c("M_FfixX","M_FdelX", "M_FfixY","M_FdelY","M_FfixA","M_FdelA")
AutFix[c(12:17)] <- ffit.aut[c(13:18)]
colnames(AutFix)[c(12:17)] <- c("F_MfixX","F_MdelX", "F_MfixY","F_MdelY","F_MfixA","F_MdelA")
AutFix_h <- AutFix[AutFix$h == 0.5,]
AutFixCompA <- ggplot(AutFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelA), colour =s,))+ #common female (allele 2)
geom_point(aes(y=(M_FdelA), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixA), shape = "Common Male", colour = s))+ #common male, allele 1
geom_line(aes(y=(F_MfixA), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial A \n"))+
ggtitle("Prob of beneficial A Fixed, rd = 0.5, h = 0.5")
# AutFixCompA <- ggdraw() + draw_plot(AutFixCompA) +
#   draw_label("Common Male", x = 0.03, y = 0.65, angle = 90, size =10) +
#   draw_label("Common Female", x = 0.03, y = 0.30, angle = 90, size =10)
AutFixCompA
SexFix <- mfit.sex[,c(4:8,13:18)]
colnames(SexFix)[1] <- "common"
colnames(SexFix)[c(6:11)] <- c("M_FfixX","M_FdelX", "M_FfixY","M_FdelY","M_FfixA","M_FdelA")
SexFix[c(12:17)] <- ffit.aut[c(13:18)]
colnames(SexFix)[c(12:17)] <- c("F_MfixX","F_MdelX", "F_MfixY","F_MdelY","F_MfixA","F_MdelA")
#X chromosome
SexFixCompX <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FfixX), colour =s,))+ #common female (allele 2) X - allele 2 is ben (fixed)
geom_point(aes(y=(M_FfixX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MdelX), shape = "Common Male", colour = s))+ #common male, allele 1 - delX
geom_line(aes(y=(F_MdelX), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial X \n"))+
ggtitle("Prob of beneficial X Fixed, rd = 0.5, h = 0.5")
SexFixCompX
#Y chromosome
SexFixCompY <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelY), colour =s,))+ #common female (allele 2) X - allele 2 is ben (del)
geom_point(aes(y=(M_FdelY), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MfixY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial Y \n"))+
ggtitle("Prob of beneficial Y Fixed, rd = 0.5, h = 0.5")
SexFixCompY
rare.male.sex.fix.X <- ggplot(simple.msex, aes(y=fixX, x=OSR))+
geom_line(aes(colour=s), linewidth=1)+ylim(c(0,1)) +
geom_point(aes(shape=s, fill=s),stat="identity", position="identity", size=3)+
scale_colour_viridis_d(end=0.9)+scale_shape_manual(values=c(21,24,22,23))+scale_fill_viridis_d(end=0.9)+
facet_grid(h~females, labeller=label_both)+theme_bw()+
theme(text= element_text(family="sans", face="plain", color="#000000", size=13, hjust=0.5, vjust=0.5))+
xlab("Operational Sex Ratio")+ylab("Female - Prob. ben X Fixed")+labs("Number of Common Sex (Female)")+ggtitle("Prob X Fixed: Rare Male, RD = 0.2")
rare.male.sex.fix.X
simple.msex<-simple.mdat[simple.mdat$rd == 0.2,] #Sex-linked
simple.msex$females<-as.factor(simple.msex$females)
simple.msex$s<-as.factor(simple.msex$s)
simple.msex$h<-as.factor(simple.msex$h)
str(simple.msex)
rare.male.sex.fix.X <- ggplot(simple.msex, aes(y=fixX, x=OSR))+
geom_line(aes(colour=s), linewidth=1)+ylim(c(0,1)) +
geom_point(aes(shape=s, fill=s),stat="identity", position="identity", size=3)+
scale_colour_viridis_d(end=0.9)+scale_shape_manual(values=c(21,24,22,23))+scale_fill_viridis_d(end=0.9)+
facet_grid(h~females, labeller=label_both)+theme_bw()+
theme(text= element_text(family="sans", face="plain", color="#000000", size=13, hjust=0.5, vjust=0.5))+
xlab("Operational Sex Ratio")+ylab("Female - Prob. ben X Fixed")+labs("Number of Common Sex (Female)")+ggtitle("Prob X Fixed: Rare Male, RD = 0.2")
rare.male.sex.fix.X
#Y set up for fixation for males ben allele 1, female is common sex so need prob that male Y doesn't fix
rare.male.sex.fix.Y <- ggplot(simple.msex, aes(y=delY, x=OSR))+
geom_line(aes(colour=s), linewidth=1)+ylim(c(0,1)) +
geom_point(aes(shape=s, fill=s),stat="identity", position="identity", size=3)+
scale_colour_viridis_d(end=0.9)+scale_shape_manual(values=c(21,24,22,23))+scale_fill_viridis_d(end=0.9)+
facet_grid(h~females, labeller=label_both)+theme_bw()+
theme(text= element_text(family="sans", face="plain", color="#000000", size=13, hjust=0.5, vjust=0.5))+
xlab("Operational Sex Ratio")+ylab("Female - Prob. ben Y Fixed")+labs("Number of Common Sex (Female)")+ggtitle("Prob Y Fixed: Rare Male, RD = 0.2")
rare.male.sex.fix.Y
fdat<-read.csv("rare.female.250.iter.csv", as.is=T, header = TRUE)
faut<-fdat[fdat$rd == 0.5,] #Autosome
faut$males<-as.factor(faut$males)
faut$h <- as.factor(faut$h)
faut$s <- as.factor(faut$s)
faut$OSR<-as.factor(faut$OSR)
rare.female.aut.freq.v.s <- ggplot(faut, aes(y=(A), x=OSR))+
scale_colour_viridis_d(end=0.9)+scale_shape_manual(values=c(21,24,22,23))+scale_fill_viridis_d(end=0.9)+
facet_grid(h~males, labeller=label_both)+theme_bw()+
theme(text= element_text(family="sans", face="plain", color="#000000", size=13, hjust=0.5, vjust=0.5))+
xlab("Operational Sex Ratio")+ylab("Male - A ben Frequency")+labs("dominance")+ggtitle("'A' Frequency: Rare Female, RD = 0.5")+
geom_violin(aes(fill=OSR))
rare.female.aut.freq.v.s
SexFixComp <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FfiX), colour =s,))+ #common female (allele 2) X - fixX
geom_point(aes(y=(M_FfixX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MfixY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial Chromosome \n"))+
ggtitle("Prob of beneficial Chr Fixed, rd = 0.5, h = 0.5")
SexFixComp
SexFixComp <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FfixX), colour =s,))+ #common female (allele 2) X - fixX
geom_point(aes(y=(M_FfixX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MfixY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial Chromosome \n"))+
ggtitle("Prob of beneficial Chr Fixed, rd = 0.5, h = 0.5")
SexFixComp
SexFixCompY
SexFixCompX
SexFixCompDel <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelX), colour =s,))+ #common female (allele 2) X - fixX
geom_point(aes(y=(M_FdelX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MdelY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MdelY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of deleterious Chromosome \n"))+
ggtitle("Prob of beneficial Chr deleted, rd = 0.5, h = 0.5")
SexFixCompDel
SexFixComp <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FfixX), colour =s,))+ #common female (allele 2) X - fixX
geom_point(aes(y=(M_FfixX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MfixY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MfixY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of beneficial Chromosome \n"))+
ggtitle("Prob of beneficial Chr Fixed, rd = 0.5, h = 0.5")
SexFixComp
SexFixCompDel <- ggplot(SexFix, aes(x = OSR))+
facet_grid(h~common)+
geom_line(aes(y=(M_FdelX), colour =s,))+ #common female (allele 2) X - fixX
geom_point(aes(y=(M_FdelX), shape = "Common Female", colour = s))+
geom_point(aes(y=(F_MdelY), shape = "Common Male", colour = s))+ #common male, allele 1 - fixY
geom_line(aes(y=(F_MdelY), colour = s))+
scale_y_continuous(limits = c(-.1,1.0), breaks = my_ticks, labels=my_labels,expand = c(0,0))+
theme(axis.line.y = element_blank(), plot.margin = unit(c(1,1,1,1), "lines"))+
ylab(expression("Frequeny of deleterious Chromosome \n"))+
ggtitle("Prob of beneficial Chr deleted, rd = 0.5, h = 0.5")
SexFixCompDel
runApp('C:/Users/pdglenn/OneDrive/TAMU/OSR/ShinyOSRx/server_ui')
